<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wanderlust - Travel Itinerary</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .glass {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
    <script>
        window.onerror = function (msg, url, line, col, error) {
            alert("Error: " + msg + "\nurl: " + url + "\nline: " + line);
            return false;
        };
        window.addEventListener('unhandledrejection', function (event) {
            alert("Unhandled Rejection: " + event.reason);
        });
    </script>
</head>

<body class="bg-gray-50 text-gray-800 antialiased min-h-screen flex flex-col">

    <!-- Navbar (Visible only on Dashboard) -->
    <nav id="navbar" class="bg-white shadow-sm sticky top-0 z-50 hidden">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-bold text-indigo-600 tracking-tight">Wanderlust</span>
                </div>
                <div class="flex items-center space-x-4">
                    <span id="user-greeting" class="text-gray-600 font-medium"></span>
                    <button onclick="logout()"
                        class="text-gray-500 hover:text-red-600 transition font-medium text-sm">Sign Out</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="flex-grow flex flex-col relative">

        <!-- Login Page -->
        <div id="login-page" class="absolute inset-0 z-40 flex items-center justify-center gradient-bg hidden">
            <div
                class="w-full max-w-md p-8 bg-white rounded-2xl shadow-2xl transform transition-all hover:scale-105 duration-300">
                <div class="text-center mb-8">
                    <h1 class="text-3xl font-bold text-gray-900">Welcome Back</h1>
                    <p class="text-gray-500 mt-2">Plan your next adventure</p>
                </div>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>
                        <input type="text" id="login-username"
                            class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition"
                            placeholder="Enter your username">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                        <input type="password" id="login-password"
                            class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition"
                            placeholder="••••••••">
                    </div>
                    <button onclick="login()"
                        class="w-full bg-indigo-600 text-white font-bold py-3 rounded-lg hover:bg-indigo-700 transition shadow-lg transform hover:-translate-y-0.5">Sign
                        In</button>
                </div>
                <div class="mt-6 text-center">
                    <p class="text-sm text-gray-600">New here? <a href="#signup"
                            class="text-indigo-600 font-semibold hover:underline">Create an account</a></p>
                </div>
            </div>
        </div>

        <!-- Signup Page -->
        <div id="signup-page" class="absolute inset-0 z-40 flex items-center justify-center gradient-bg hidden">
            <div
                class="w-full max-w-md p-8 bg-white rounded-2xl shadow-2xl transform transition-all hover:scale-105 duration-300">
                <div class="text-center mb-8">
                    <h1 class="text-3xl font-bold text-gray-900">Join Wanderlust</h1>
                    <p class="text-gray-500 mt-2">Start your journey today</p>
                </div>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Choose Username</label>
                        <input type="text" id="signup-username"
                            class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition"
                            placeholder="username">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Choose Password</label>
                        <input type="password" id="signup-password"
                            class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition"
                            placeholder="••••••••">
                    </div>
                    <button onclick="signup()"
                        class="w-full bg-green-500 text-white font-bold py-3 rounded-lg hover:bg-green-600 transition shadow-lg transform hover:-translate-y-0.5">Create
                        Account</button>
                </div>
                <div class="mt-6 text-center">
                </div>
            </div>
        </div>

        <!-- Dashboard Page -->
        <div id="dashboard-page" class="w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 hidden">

            <!-- Header Section -->
            <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-8">
                <div>
                    <h2 class="text-3xl font-bold text-gray-900">Your Trips</h2>
                    <p class="text-gray-500 mt-1">Manage your itineraries and schedules</p>
                </div>
                <div class="mt-4 md:mt-0">
                    <button onclick="document.getElementById('create-travel-modal').classList.remove('hidden')"
                        class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-full shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition">
                        + New Trip
                    </button>
                </div>
            </div>

            <!-- Recommendations Section -->
            <div class="mb-12">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">✨ Recommended for You</h2>
                <div id="recommendation-list" class="flex space-x-4 overflow-x-auto pb-4">
                    <!-- Recommendations injected here -->
                    <div
                        class="flex-shrink-0 w-64 h-40 bg-gray-100 rounded-xl flex items-center justify-center text-gray-400">
                        Loading...
                    </div>
                </div>
            </div>

            <!-- Travel Grid -->
            <div id="travel-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Travel Cards Injected Here -->
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="hidden text-center py-20">
                <div class="inline-block p-6 rounded-full bg-indigo-50 mb-4">
                    <svg class="w-12 h-12 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4">
                        </path>
                    </svg>
                </div>
                <h3 class="text-lg font-medium text-gray-900">No trips yet</h3>
                <p class="text-gray-500 mt-1">Get started by creating your first travel plan.</p>
            </div>
        </div>
    </main>

    <!-- Create Travel Modal -->
    <div id="create-travel-modal" class="fixed inset-0 z-50 hidden overflow-y-auto" aria-labelledby="modal-title"
        role="dialog" aria-modal="true">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"
                onclick="this.parentElement.parentElement.classList.add('hidden')"></div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            <div
                class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title">Create New Trip</h3>
                    <div class="mt-4 space-y-4">
                        <input type="text" id="travel-title" placeholder="Trip Title (e.g., Summer in Paris)"
                            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
                        <textarea id="travel-desc" rows="3" placeholder="Description"
                            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"></textarea>
                    </div>
                </div>
                <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" onclick="createTravel()"
                        class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm">Create</button>
                    <button type="button"
                        onclick="document.getElementById('create-travel-modal').classList.add('hidden')"
                        class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Recommendation Details Modal -->
    <div id="recommendation-modal" class="fixed inset-0 z-50 hidden overflow-y-auto" aria-labelledby="modal-title"
        role="dialog" aria-modal="true">
        <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity" aria-hidden="true"
                onclick="closeRecommendationModal()"></div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            <div
                class="inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full">
                <div class="relative">
                    <img id="rec-modal-image" src="" alt="Travel Destination" class="w-full h-64 object-cover">
                    <div class="absolute top-0 right-0 p-4">
                        <button onclick="closeRecommendationModal()"
                            class="bg-white rounded-full p-2 shadow-lg hover:bg-gray-100 transition">
                            <svg class="w-6 h-6 text-gray-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent p-6">
                        <h3 id="rec-modal-title" class="text-3xl font-bold text-white"></h3>
                        <p id="rec-modal-country" class="text-indigo-200 font-medium text-lg"></p>
                    </div>
                </div>
                <div class="px-6 py-6">
                    <div class="flex items-center justify-between mb-6">
                        <div
                            class="bg-indigo-50 text-indigo-700 px-4 py-2 rounded-full text-sm font-bold flex items-center">
                            <span class="mr-2">✨ Match Score</span>
                            <span id="rec-modal-score" class="text-lg"></span>
                        </div>
                        <div class="text-sm text-gray-500">
                            Recommended by <span id="rec-modal-author" class="font-medium text-gray-900"></span>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="text-sm font-bold text-gray-900 uppercase tracking-wide mb-2">Why Recommended?</h4>
                        <div class="bg-green-50 border border-green-100 rounded-lg p-4">
                            <p id="rec-modal-reason" class="text-green-800 font-medium"></p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="text-sm font-bold text-gray-900 uppercase tracking-wide mb-2">About</h4>
                        <p id="rec-modal-desc" class="text-gray-600 leading-relaxed"></p>
                    </div>

                    <div class="flex justify-end">
                        <button onclick="closeRecommendationModal()"
                            class="w-full sm:w-auto bg-gray-100 text-gray-700 font-bold py-3 px-6 rounded-xl hover:bg-gray-200 transition">
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Schedule Modal (Full Screen Slide-over style) -->
    <div id="schedule-modal" class="fixed inset-0 z-50 hidden overflow-hidden">
        <div class="absolute inset-0 overflow-hidden">
            <div class="absolute inset-0 bg-gray-500 bg-opacity-75 transition-opacity" onclick="closeModal()"></div>
            <section class="absolute inset-y-0 right-0 pl-10 max-w-full flex">
                <div class="w-screen max-w-md">
                    <div class="h-full flex flex-col bg-white shadow-xl overflow-y-scroll">
                        <div class="py-6 px-4 bg-indigo-600 sm:px-6">
                            <div class="flex items-center justify-between">
                                <h2 class="text-lg font-medium text-white">Itinerary Details</h2>
                                <button onclick="closeModal()"
                                    class="rounded-md text-indigo-200 hover:text-white focus:outline-none">
                                    <span class="sr-only">Close panel</span>
                                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>
                            <div class="mt-1">
                                <p class="text-sm text-indigo-200">Manage your daily activities.</p>
                            </div>
                        </div>
                        <div class="relative flex-1 py-6 px-4 sm:px-6">
                            <input type="hidden" id="current-travel-id">

                            <!-- Add Schedule Form -->
                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mb-6">
                                <h4 class="text-sm font-bold text-gray-700 uppercase tracking-wide mb-3">Add New
                                    Activity</h4>
                                <div class="space-y-3">
                                    <input type="date" id="sched-date" class="w-full p-2 border rounded text-sm">
                                    <input type="text" id="sched-place" placeholder="Place / Activity"
                                        class="w-full p-2 border rounded text-sm">
                                    <input type="text" id="sched-memo" placeholder="Notes (optional)"
                                        class="w-full p-2 border rounded text-sm">
                                    <button onclick="createSchedule()"
                                        class="w-full bg-indigo-600 text-white py-2 rounded text-sm font-medium hover:bg-indigo-700 transition">Add
                                        to Itinerary</button>
                                </div>
                            </div>

                            <!-- Timeline -->
                            <div class="flow-root">
                                <ul id="schedule-list" class="-mb-8">
                                    <!-- Schedules injected here -->
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <script type="module" src="js/app.js"></script>
</body>

</html>